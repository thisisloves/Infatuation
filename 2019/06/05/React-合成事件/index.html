<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>React合成事件 | 亦如星辰闪耀长河</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  
  
  <meta name="description" content="世间一切幸福，皆月影中一现的昙花；唯有孤独与痛，常伴在黄泉深处。">
<meta property="og:type" content="article">
<meta property="og:title" content="React合成事件">
<meta property="og:url" content="https://thisisloves.github.io/Infatuation/2019/06/05/React-%E5%90%88%E6%88%90%E4%BA%8B%E4%BB%B6/index.html">
<meta property="og:site_name" content="亦如星辰闪耀长河">
<meta property="og:description" content="世间一切幸福，皆月影中一现的昙花；唯有孤独与痛，常伴在黄泉深处。">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://thisisloves.github.io/images/2022/05/06/hu4xEkMODP5bGdF.png">
<meta property="og:image" content="https://thisisloves.github.io/images/2022/05/06/7mcKb5TeU196dPr.png">
<meta property="article:published_time" content="2019-06-04T16:00:00.000Z">
<meta property="article:modified_time" content="2023-06-27T06:20:01.025Z">
<meta property="article:author" content="Infatuation">
<meta property="article:tag" content="React">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://thisisloves.github.io/images/2022/05/06/hu4xEkMODP5bGdF.png">
  
    <link rel="alternate" href="/atom.xml" title="亦如星辰闪耀长河" type="application/atom+xml">
  
  
    <link rel="icon" href="/images/2019/05/20/5ce292afb9f6b42428.jpeg">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

  
<link rel="stylesheet" href="/css/highlight.css">

<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="fullpage" class="mobile-nav-right">
    
      <div id="wrapper" title="">
    
    
      <header id="header">
  <div id="nav-toggle" class="nav-toggle"></div>
  <div class="head-box global-width">
    <nav class="nav-box nav-right">
      
        <a class="nav-item" href="/" title
        
        >首页</a>
      
        <a class="nav-item" href="/archives" title
        
        >归档</a>
      
        <a class="nav-item" href="https://thisisloves.github.io/chart" title
        
        >图表</a>
      
        <a class="nav-item" href="https://thisisloves.github.io/shop/" title
        
        >购物</a>
      
        <a class="nav-item" href="https://thisisloves.github.io/cherry" title
        
        >半帘梦</a>
      
        <a class="nav-item" href="https://thisisloves.github.io/userInfo/index.html" title
        
        >个人中心</a>
      
    </nav>
  </div>
</header>
      <div id="middlecontent" title class="global-width sidebar-right">
        <section id="main"><article id="post-React-合成事件" class="article global-container article-type-post" itemscope itemprop="blogPost">
  
    <header class="article-header">
      
  
    <h1 class="article-title" itemprop="name">
      React合成事件
    </h1>
  

    </header>
  
  <div class="article-meta">
    <a href="/2019/06/05/React-%E5%90%88%E6%88%90%E4%BA%8B%E4%BB%B6/" class="article-date">
  <time datetime="2019-06-04T16:00:00.000Z" itemprop="datePublished">2019-06-05</time>
</a>
    
    
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/React/" rel="tag">React</a></li></ul>

  </div>
  
    <span id="busuanzi_container_page_pv">
      本文总阅读量<span id="busuanzi_value_page_pv"></span>次
    </span>
  

  <div class="article-inner">
    
    <div class="article-content article-content-doorframe" itemprop="articleBody">
      
        <p>世间一切幸福，皆月影中一现的昙花；唯有孤独与痛，常伴在黄泉深处。</p>
<span id="more"></span>

<h3 id="合成事件"><a href="#合成事件" class="headerlink" title="合成事件"></a>合成事件</h3><ul>
<li>React 自己实现了一套高效的事件注册，存储，分发和重用逻辑，在 DOM 事件体系基础上做了很大改进，减少了内存消耗，简化了事件逻辑，并最大化的解决了 IE 等浏览器的不兼容问题。</li>
</ul>
<h3 id="合成事件特点"><a href="#合成事件特点" class="headerlink" title="合成事件特点"></a>合成事件特点</h3><ol>
<li>React 组件上声明的事件最终绑定到了 document 这个 DOM 节点上，而不是 React 组件对应的 DOM 节点。故只有 document 这个节点上面才绑定了 DOM 原生事件，其他节点没有绑定事件。这样简化了 DOM 原生事件，减少了内存开销。</li>
<li>React 以队列的方式，从触发事件的组件向父组件回溯，调用它们在 JSX 中声明的 callback。也就是 React 自身实现了一套事件冒泡机制。我们没办法用 event。stopPropagation()来停止事件传播，应该使用 event.preventDefault()。</li>
<li>React 有一套自己的合成事件 SyntheticEvent，不同类型的事件会构造不同的 SyntheticEvent。</li>
<li>React 使用对象池来管理合成事件对象的创建和销毁，这样减少了垃圾的生成和新对象内存的分配，大大提高了性能。</li>
</ol>
<h3 id="合成事件的原理"><a href="#合成事件的原理" class="headerlink" title="合成事件的原理"></a>合成事件的原理</h3><ul>
<li>通过冒泡事件冒泡到顶层元素，再统一分发处理。</li>
</ul>
<p><img src="/images/2022/05/06/hu4xEkMODP5bGdF.png" alt="截屏2022-05-06 上午10.07.12.png"></p>
<h3 id="react-事件系统"><a href="#react-事件系统" class="headerlink" title="react 事件系统"></a>react 事件系统</h3><p><img src="/images/2022/05/06/7mcKb5TeU196dPr.png" alt="截屏2022-05-06 下午2.30.30.png"></p>
<ul>
<li><p>浏览器事件（如用户点击了某个 button）触发后，DOM 将 event 传给 ReactEventListener，它将事件分发到当前组件及以上的父组件。然后由 ReactEventEmitter 对每个组件进行事件的执行，先构造 React 合成事件，然后以 queue 的方式调用 JSX 中声明的 callback 进行事件回调。</p>
</li>
<li><p>涉及主要的类</p>
</li>
</ul>
<ol>
<li><p>ReactEventListener：负责事件注册和事件分发。React 将 DOM 事件全都注册到 document 这个节点上，这个我们在事件注册小节详细讲。事件分发主要调用<br>dispatchEvent 进行，从事件触发组件开始，向父元素遍历。我们在事件执行小节详细讲。</p>
</li>
<li><p>ReactEventEmitter：负责每个组件上事件的执行。</p>
</li>
<li><p>EventPluginHub：负责事件的存储，合成事件以对象池的方式实现创建和销毁，大大提高了性能。</p>
</li>
<li><p>SimpleEventPlugin 等 plugin：根据不同的事件类型，构造不同的合成事件。如 focus 对应的 React 合成事件为 SyntheticFocusEvent</p>
</li>
</ol>
<h3 id="事件注册"><a href="#事件注册" class="headerlink" title="事件注册"></a>事件注册</h3><ul>
<li>react 声明事件</li>
</ul>
<div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">onClick</span> = <span class="string">&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            (<span class="attr">event</span>) =&gt;</span> &#123;console.log(JSON.stringify(event))&#125;</span></span><br><span class="line"><span class="language-xml">        &#125;</span></span><br><span class="line"><span class="language-xml">    /&gt;</span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<ul>
<li>enqueuePutListener，它负责注册 JSX 中声明的事件</li>
</ul>
<div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// inst: React Component对象</span></span><br><span class="line"><span class="comment">// registrationName: React合成事件名，如onClick</span></span><br><span class="line"><span class="comment">// listener: React事件回调方法，如onClick=callback中的callback</span></span><br><span class="line"><span class="comment">// transaction: mountComponent或updateComponent所处的事务流中，React都是基于事务流的</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">enqueuePutListener</span>(<span class="params">inst, registrationName, listener, transaction</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (transaction <span class="keyword">instanceof</span> <span class="title class_">ReactServerRenderingTransaction</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span> containerInfo = inst.<span class="property">_hostContainerInfo</span>;</span><br><span class="line">  <span class="keyword">var</span> isDocumentFragment = containerInfo.<span class="property">_node</span> &amp;&amp; containerInfo.<span class="property">_node</span>.<span class="property">nodeType</span> === <span class="variable constant_">DOC_FRAGMENT_TYPE</span>;</span><br><span class="line">  <span class="comment">// 找到document</span></span><br><span class="line">  <span class="keyword">var</span> doc = isDocumentFragment ? containerInfo.<span class="property">_node</span> : containerInfo.<span class="property">_ownerDocument</span>;</span><br><span class="line">  <span class="comment">// 注册事件，将事件注册到document上</span></span><br><span class="line">  <span class="title function_">listenTo</span>(registrationName, doc);</span><br><span class="line">  <span class="comment">// 存储事件,放入事务队列中</span></span><br><span class="line">  transaction.<span class="title function_">getReactMountReady</span>().<span class="title function_">enqueue</span>(putListener, &#123;</span><br><span class="line">    <span class="attr">inst</span>: inst,</span><br><span class="line">    <span class="attr">registrationName</span>: registrationName,</span><br><span class="line">    <span class="attr">listener</span>: listener</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<ul>
<li>enqueuePutListener 主要做两件事，一方面将事件注册到 document 这个原生 DOM 上（这就是为什么只有 document 这个节点有 DOM 事件的原因），另一方面采用事务队列的方式调用 putListener 将注册的事件存储起来，以供事件触发时回调。</li>
<li>注册事件的入口是 listenTo 方法, 它解决了不同浏览器间捕获和冒泡不兼容的问题。在 listen 方法中只有 document 节点才会调用这个 addEventListener 这个原生事件注册方法，故仅仅只有 document 节点上才有 DOM 事件。这大大简化了 DOM 事件逻辑，也节约了内存。</li>
</ul>
<h3 id="事件存储"><a href="#事件存储" class="headerlink" title="事件存储"></a>事件存储</h3><ul>
<li>事件存储由 EventPluginHub 来负责，它的入口在 enqueuePutListener 中的 putListener 方法</li>
</ul>
<div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * EventPluginHub用来存储React事件, 将listener存储到`listenerBank[registrationName][key]`</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">object</span>&#125; inst: 事件源</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; listener的名字,比如onClick</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">function</span>&#125; listener的callback</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  <span class="attr">putListener</span>: <span class="keyword">function</span> (<span class="params">inst, registrationName, listener</span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 用来标识注册了事件,比如onClick的React对象。key的格式为&#x27;.nodeId&#x27;, 只用知道它可以标示哪个React对象就可以了</span></span><br><span class="line">    <span class="keyword">var</span> key = <span class="title function_">getDictionaryKey</span>(inst);</span><br><span class="line">    <span class="keyword">var</span> bankForRegistrationName = listenerBank[registrationName] || (listenerBank[registrationName] = &#123;&#125;);</span><br><span class="line">    <span class="comment">// 将listener事件回调方法存入listenerBank[registrationName][key]中,比如listenerBank[&#x27;onclick&#x27;][nodeId]</span></span><br><span class="line">    <span class="comment">// 所有React组件对象定义的所有React事件都会存储在listenerBank中</span></span><br><span class="line">    bankForRegistrationName[key] = listener;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//onSelect和onClick注册了两个事件回调插件, 用于walkAround某些浏览器兼容bug,不用care</span></span><br><span class="line">    <span class="keyword">var</span> <span class="title class_">PluginModule</span> = <span class="title class_">EventPluginRegistry</span>.<span class="property">registrationNameModules</span>[registrationName];</span><br><span class="line">    <span class="keyword">if</span> (<span class="title class_">PluginModule</span> &amp;&amp; <span class="title class_">PluginModule</span>.<span class="property">didPutListener</span>) &#123;</span><br><span class="line">      <span class="title class_">PluginModule</span>.<span class="title function_">didPutListener</span>(inst, registrationName, listener);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> getDictionaryKey = <span class="keyword">function</span> (<span class="params">inst</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;.&#x27;</span> + inst.<span class="property">_rootNodeID</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<ul>
<li>事件存储在了 listenerBank 对象中，它按照事件名和 React 组件对象进行了二维划分。</li>
</ul>
<h3 id="事件执行分发"><a href="#事件执行分发" class="headerlink" title="事件执行分发"></a>事件执行分发</h3><ul>
<li>当事件触发的，document 上的 callback 会被回调。从前面事件注册部分发现，此时回调函数为 ReactEventListener.dispatchEvent，它是事件分发的入口方法。</li>
</ul>
<div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="title class_">ReactEventListener</span> = &#123;</span><br><span class="line">  <span class="comment">// topLevelType：事件名</span></span><br><span class="line">  <span class="comment">// nativeEvent: 用户触发click等事件时，浏览器传递的原生事件</span></span><br><span class="line">  <span class="attr">dispatchEvent</span>: <span class="keyword">function</span> (<span class="params">topLevelType, nativeEvent</span>) &#123;</span><br><span class="line">    ...</span><br><span class="line">   <span class="comment">// 放入批处理队列中,React事件流也是一个消息队列的方式</span></span><br><span class="line">    <span class="title class_">ReactUpdates</span>.<span class="title function_">batchedUpdates</span>(handleTopLevelImpl, bookKeeping);</span><br><span class="line">    ...</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//handleTopLevelImpl才是事件分发的真正执行者，它是事件分发的核心，体现了React事件分发的特点</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">handleTopLevelImpl</span>(<span class="params">bookKeeping</span>) &#123;</span><br><span class="line">  <span class="comment">//根据原生的事件对象，找到事件触发的dom元素以及该dom对应的component对象</span></span><br><span class="line">  <span class="keyword">var</span> nativeEventTarget = <span class="title function_">getEventTarget</span>(bookKeeping.<span class="property">nativeEvent</span>);</span><br><span class="line">  <span class="keyword">var</span> targetInst = <span class="title class_">ReactDOMComponentTree</span>.<span class="title function_">getClosestInstanceFromNode</span>(nativeEventTarget);</span><br><span class="line"> <span class="comment">// 执行事件回调前,先由当前组件向上遍历它的所有父组件。得到ancestors这个数组。</span></span><br><span class="line">  <span class="comment">// 因为事件回调中可能会改变Virtual DOM结构,所以要先遍历好组件层级</span></span><br><span class="line">  <span class="keyword">var</span> ancestor = targetInst;</span><br><span class="line">  <span class="keyword">do</span> &#123;</span><br><span class="line">    bookKeeping.<span class="property">ancestors</span>.<span class="title function_">push</span>(ancestor);</span><br><span class="line">    ancestor = ancestor &amp;&amp; <span class="title function_">findParent</span>(ancestor);</span><br><span class="line">  &#125; <span class="keyword">while</span> (ancestor);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 从当前组件向父组件遍历,依次执行注册的回调方法. 我们遍历构造ancestors数组时,是从当前组件向父组件回溯的,故此处事件回调也是这个顺序</span></span><br><span class="line">  <span class="comment">// 这个顺序就是冒泡的顺序,并且我们发现不能通过stopPropagation来阻止&#x27;冒泡&#x27;。</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; bookKeeping.<span class="property">ancestors</span>.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    targetInst = bookKeeping.<span class="property">ancestors</span>[i];</span><br><span class="line">     <span class="comment">// _handleTopLevel是初始化时用ReactEventEmitterMixin注入进来的</span></span><br><span class="line">    <span class="title class_">ReactEventListener</span>.<span class="title function_">_handleTopLevel</span>(bookKeeping.<span class="property">topLevelType</span>, targetInst, bookKeeping.<span class="property">nativeEvent</span>, <span class="title function_">getEventTarget</span>(bookKeeping.<span class="property">nativeEvent</span>));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ReactEventEmitterMixin.js</span></span><br><span class="line"><span class="comment">// ReactEventEmitterMixin一方面生成合成的事件对象，另一方面批量执行定义的回调函数</span></span><br><span class="line"><span class="keyword">var</span> <span class="title class_">ReactEventEmitterMixin</span> = &#123;</span><br><span class="line">  <span class="comment">// handleTopLevel方法是事件回调函数调用的核心。DOM事件绑定在了document原生对象上,每次事件触发,都会调用到handleTopLevel</span></span><br><span class="line">  <span class="attr">handleTopLevel</span>: <span class="keyword">function</span> (<span class="params">...</span>) &#123;</span><br><span class="line">    <span class="comment">// 利用浏览器回传的原生事件构造出React合成事件。不同的eventType的合成事件可能不同</span></span><br><span class="line">    <span class="keyword">var</span> events = <span class="title class_">EventPluginHub</span>.<span class="title function_">extractEvents</span>(...);</span><br><span class="line">    <span class="comment">//采用队列的方式处理回调函数</span></span><br><span class="line">    <span class="title function_">runEventQueueInBatch</span>(events);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//进行批量更新</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">runEventQueueInBatch</span>(<span class="params">events</span>) &#123;</span><br><span class="line">  <span class="title class_">EventPluginHub</span>.<span class="title function_">enqueueEvents</span>(events);</span><br><span class="line">  <span class="title class_">EventPluginHub</span>.<span class="title function_">processEventQueue</span>(<span class="literal">false</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<ul>
<li>React 自身实现了一套冒泡机制。从触发事件的对象开始，向父元素回溯，依次调用它们注册的事件 callback。</li>
</ul>
<h3 id="生成合成事件"><a href="#生成合成事件" class="headerlink" title="生成合成事件"></a>生成合成事件</h3><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// EventPluginHub.js</span></span><br><span class="line"><span class="keyword">var</span> <span class="title class_">EventPluginHub</span> = &#123;</span><br><span class="line">  <span class="attr">extractEvents</span>: <span class="keyword">function</span> (<span class="params">...</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> events;</span><br><span class="line">    <span class="comment">// EventPluginHub可以存储React合成事件的callback,也存储了一些plugin,这些plugin在EventPluginHub初始化时注册的</span></span><br><span class="line">    <span class="keyword">var</span> plugins = <span class="title class_">EventPluginRegistry</span>.<span class="property">plugins</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; plugins.<span class="property">length</span>; i++) &#123;</span><br><span class="line">      <span class="keyword">var</span> possiblePlugin = plugins[i];</span><br><span class="line">      <span class="keyword">if</span> (possiblePlugin) &#123;</span><br><span class="line">        <span class="comment">// 根据eventType构造不同的合成事件SyntheticEvent</span></span><br><span class="line">        <span class="keyword">var</span> extractedEvents = possiblePlugin.<span class="title function_">extractEvents</span>(topLevelType, targetInst, nativeEvent, nativeEventTarget);</span><br><span class="line">        <span class="keyword">if</span> (extractedEvents) &#123;</span><br><span class="line">          <span class="comment">// 将构造好的合成事件extractedEvents添加到events数组中,这样就保存了所有plugin构造的合成事件</span></span><br><span class="line">          events = <span class="title function_">accumulateInto</span>(events, extractedEvents);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> events;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<ul>
<li>系统启动过程中注入(injection)过来 plugins，代码如下：</li>
</ul>
<div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// react-dom模块的入口文件ReactDOM.js:</span></span><br><span class="line"><span class="keyword">var</span> <span class="title class_">ReactDefaultInjection</span> = <span class="built_in">require</span>(<span class="string">&#x27;./ReactDefaultInjection&#x27;</span>);</span><br><span class="line"><span class="title class_">ReactDefaultInjection</span>.<span class="title function_">inject</span>();</span><br><span class="line">...</span><br><span class="line"><span class="comment">// ReactDefaultInjection.js</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">inject</span>: inject</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">inject</span>(<span class="params"></span>) &#123;</span><br><span class="line">  ...</span><br><span class="line">  <span class="title class_">ReactInjection</span>.<span class="property">EventPluginHub</span>.<span class="title function_">injectEventPluginsByName</span>(&#123;</span><br><span class="line">    <span class="title class_">SimpleEventPlugin</span>: <span class="title class_">SimpleEventPlugin</span>,</span><br><span class="line">    <span class="title class_">EnterLeaveEventPlugin</span>: <span class="title class_">EnterLeaveEventPlugin</span>,</span><br><span class="line">    <span class="title class_">ChangeEventPlugin</span>: <span class="title class_">ChangeEventPlugin</span>,</span><br><span class="line">    <span class="title class_">SelectEventPlugin</span>: <span class="title class_">SelectEventPlugin</span>,</span><br><span class="line">    <span class="title class_">BeforeInputEventPlugin</span>: <span class="title class_">BeforeInputEventPlugin</span></span><br><span class="line">  &#125;);</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<ul>
<li>默认情况下，react 注入了五种事件 plugin，针对不同的事件，得到不同的合成事件，下面看一下最常见的 SimpleEventPlugin 如何生成它对应的 React 合成事件，代码如下：</li>
</ul>
<div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">// 根据不同事件类型,比如click,focus构造不同的合成事件SyntheticEvent, 如SyntheticKeyboardEvent SyntheticFocusEvent</span></span><br><span class="line"><span class="attr">extractEvents</span>: <span class="keyword">function</span> (<span class="params">topLevelType, targetInst, nativeEvent, nativeEventTarget</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> dispatchConfig = topLevelEventsToDispatchConfig[topLevelType];</span><br><span class="line">    <span class="keyword">if</span> (!dispatchConfig) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> <span class="title class_">EventConstructor</span>;</span><br><span class="line"></span><br><span class="line">   <span class="comment">// 根据事件类型，采用不同的SyntheticEvent来构造不同的合成事件</span></span><br><span class="line">    <span class="keyword">switch</span> (topLevelType) &#123;</span><br><span class="line">      ... <span class="comment">// 仅以blur和focus为例</span></span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;topBlur&#x27;</span>:</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;topFocus&#x27;</span>:</span><br><span class="line">        <span class="title class_">EventConstructor</span> = <span class="title class_">SyntheticFocusEvent</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      ...</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 从event对象池中取出合成事件对象</span></span><br><span class="line">    <span class="keyword">var</span> event = <span class="title class_">EventConstructor</span>.<span class="title function_">getPooled</span>(dispatchConfig, targetInst, nativeEvent, nativeEventTarget);</span><br><span class="line">   <span class="comment">//用于从EventPluginHub中获取回调函数</span></span><br><span class="line">    <span class="title class_">EventPropagators</span>.<span class="title function_">accumulateTwoPhaseDispatches</span>(event);</span><br><span class="line">    <span class="keyword">return</span> event;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure></div>

<ul>
<li>调用 EventPropagators.accumulateTwoPhaseDispatches(event)从 EventPluginHub 中获取回调函数，如何获取具体的回调函数，如下：</li>
</ul>
<div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// EventPropagators.js</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">accumulateTwoPhaseDispatches</span>(<span class="params">events</span>) &#123;</span><br><span class="line">  <span class="title function_">forEachAccumulated</span>(events, accumulateTwoPhaseDispatchesSingle);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">accumulateTwoPhaseDispatchesSingle</span>(<span class="params">event</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (event &amp;&amp; event.<span class="property">dispatchConfig</span>.<span class="property">phasedRegistrationNames</span>) &#123;</span><br><span class="line">    <span class="title class_">EventPluginUtils</span>.<span class="title function_">traverseTwoPhase</span>(event.<span class="property">_targetInst</span>, accumulateDirectionalDispatches, event);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">accumulateDirectionalDispatches</span>(<span class="params">inst, phase, event</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> listener = <span class="title function_">listenerAtPhase</span>(inst, event, phase);</span><br><span class="line">  <span class="keyword">if</span> (listener) &#123;</span><br><span class="line">    event.<span class="property">_dispatchListeners</span> = <span class="title function_">accumulateInto</span>(event.<span class="property">_dispatchListeners</span>, listener);</span><br><span class="line">    event.<span class="property">_dispatchInstances</span> = <span class="title function_">accumulateInto</span>(event.<span class="property">_dispatchInstances</span>, inst);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> getListener = <span class="title class_">EventPluginHub</span>.<span class="property">getListener</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">listenerAtPhase</span>(<span class="params">inst, event, propagationPhase</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> registrationName = event.<span class="property">dispatchConfig</span>.<span class="property">phasedRegistrationNames</span>[propagationPhase];</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">getListener</span>(inst, registrationName);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// EventPluginHub.js</span></span><br><span class="line"><span class="attr">getListener</span>: <span class="keyword">function</span> (<span class="params">inst, registrationName</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> bankForRegistrationName = listenerBank[registrationName];</span><br><span class="line">  <span class="keyword">var</span> key = <span class="title function_">getDictionaryKey</span>(inst);</span><br><span class="line">  <span class="keyword">return</span> bankForRegistrationName &amp;&amp; bankForRegistrationName[key];</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure></div>

<h3 id="批量处理回调函数"><a href="#批量处理回调函数" class="headerlink" title="批量处理回调函数"></a>批量处理回调函数</h3><ul>
<li>回调函数的执行为两步，源码如下：</li>
</ul>
<div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">runEventQueueInBatch</span>(<span class="params">events</span>) &#123;</span><br><span class="line">  <span class="comment">// 第一步：将events事件放入队列中</span></span><br><span class="line">  <span class="title class_">EventPluginHub</span>.<span class="title function_">enqueueEvents</span>(events);</span><br><span class="line">  <span class="comment">// 第二部：处理队列中的事件,包括之前未处理完的。先入先处理原则</span></span><br><span class="line">  <span class="title class_">EventPluginHub</span>.<span class="title function_">processEventQueue</span>(<span class="literal">false</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<ul>
<li>第一步源码如下：</li>
</ul>
<div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> eventQueue = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">var</span> <span class="title class_">EventPluginHub</span> = &#123;</span><br><span class="line">  <span class="attr">enqueueEvents</span>: <span class="keyword">function</span> (<span class="params">events</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (events) &#123;</span><br><span class="line">      eventQueue = <span class="title function_">accumulateInto</span>(eventQueue, events);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">processEventQueue</span>: <span class="keyword">function</span> (<span class="params">simulated</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> processingEventQueue = eventQueue;</span><br><span class="line">    ...</span><br><span class="line">    <span class="title function_">forEachAccumulated</span>(processingEventQueue, executeDispatchesAndReleaseSimulated);</span><br><span class="line">    ...</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">accumulateInto</span>(<span class="params">current, next</span>) &#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (current == <span class="literal">null</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> next;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 将next添加到current中,返回一个包含他们两个的新数组</span></span><br><span class="line">  <span class="comment">// 如果next是数组,current不是数组,采用push方法,否则采用concat方法</span></span><br><span class="line">  <span class="comment">// 如果next不是数组,则返回一个current和next构成的新数组</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="title class_">Array</span>.<span class="title function_">isArray</span>(current)) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title class_">Array</span>.<span class="title function_">isArray</span>(next)) &#123;</span><br><span class="line">      current.<span class="property">push</span>.<span class="title function_">apply</span>(current, next);</span><br><span class="line">      <span class="keyword">return</span> current;</span><br><span class="line">    &#125;</span><br><span class="line">    current.<span class="title function_">push</span>(next);</span><br><span class="line">    <span class="keyword">return</span> current;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (<span class="title class_">Array</span>.<span class="title function_">isArray</span>(next)) &#123;</span><br><span class="line">    <span class="keyword">return</span> [current].<span class="title function_">concat</span>(next);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> [current, next];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<ul>
<li>第二步事件执行的入口方法为 executeDispatchesAndReleaseTopLevel，代码如下：</li>
</ul>
<div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> executeDispatchesAndReleaseTopLevel = <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">executeDispatchesAndRelease</span>(e, <span class="literal">false</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> executeDispatchesAndRelease = <span class="keyword">function</span> (<span class="params">event, simulated</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (event) &#123;</span><br><span class="line">    <span class="comment">//进行事件分发</span></span><br><span class="line">    <span class="title class_">EventPluginUtils</span>.<span class="title function_">executeDispatchesInOrder</span>(event, simulated);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!event.<span class="title function_">isPersistent</span>()) &#123;</span><br><span class="line">      <span class="comment">// 处理完,则release掉event对象,采用对象池方式,减少GC</span></span><br><span class="line">      <span class="comment">// React帮我们处理了合成事件的回收机制，不需要我们关心。但要注意，如果使用了DOM原生事件，则要自己回收</span></span><br><span class="line">      event.<span class="property">constructor</span>.<span class="title function_">release</span>(event);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// EventPluginUtils.js</span></span><br><span class="line"><span class="comment">// 事件处理的核心</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">executeDispatchesInOrder</span>(<span class="params">event, simulated</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> dispatchListeners = event.<span class="property">_dispatchListeners</span>;</span><br><span class="line">  <span class="keyword">var</span> dispatchInstances = event.<span class="property">_dispatchInstances</span>;</span><br><span class="line">  <span class="keyword">if</span> (<span class="title class_">Array</span>.<span class="title function_">isArray</span>(dispatchListeners)) &#123;</span><br><span class="line">    <span class="comment">// 如果有多个listener,则遍历执行数组中event</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; dispatchListeners.<span class="property">length</span>; i++) &#123;</span><br><span class="line">      <span class="comment">// 如果isPropagationStopped设成true了,则停止事件传播,退出循环。</span></span><br><span class="line">      <span class="keyword">if</span> (event.<span class="title function_">isPropagationStopped</span>()) &#123;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 执行event的分发,从当前触发事件元素向父元素遍历</span></span><br><span class="line">      <span class="comment">// event为浏览器上传的原生事件</span></span><br><span class="line">      <span class="comment">// dispatchListeners[i]为JSX中声明的事件callback</span></span><br><span class="line">      <span class="comment">// dispatchInstances[i]为对应的React Component</span></span><br><span class="line">      <span class="title function_">executeDispatch</span>(event, simulated, dispatchListeners[i], dispatchInstances[i]);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (dispatchListeners) &#123;</span><br><span class="line">    <span class="comment">// 如果只有一个listener,则直接执行事件分发</span></span><br><span class="line">    <span class="title function_">executeDispatch</span>(event, simulated, dispatchListeners, dispatchInstances);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 处理完event,重置变量。因为使用的对象池,故必须重置,这样才能被别人复用</span></span><br><span class="line">  event.<span class="property">_dispatchListeners</span> = <span class="literal">null</span>;</span><br><span class="line">  event.<span class="property">_dispatchInstances</span> = <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

      
    </div>
    
      <footer class="article-footer">
        完
      </footer>
    
  </div>
  
    
<nav id="article-nav">
  <div class="article-nav-block">
    
      <a href="/2019/06/11/React-%E7%88%B6%E7%BB%84%E4%BB%B6%E8%B0%83%E7%94%A8%E5%AD%90%E7%BB%84%E4%BB%B6%E6%96%B9%E6%B3%95/" id="article-nav-newer" class="article-nav-link-wrap">
        <strong class="article-nav-caption"></strong>
        <div class="article-nav-title">
          
            React父组件调用子组件方法
          
        </div>
      </a>
    
  </div>
  <div class="article-nav-block">
    
      <a href="/2019/06/03/Vue-%E6%8F%92%E6%A7%BD/" id="article-nav-older" class="article-nav-link-wrap">
        <div class="article-nav-title">Vue插槽</div>
        <strong class="article-nav-caption"></strong>
      </a>
    
  </div>
</nav>

    
<div id="gitmentContainer"></div>
<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">
<script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>
<script>
var gitment = new Gitment({
  owner: 'thisisloves',
  repo: '',
  oauth: {
    client_id: '',
    client_secret: '',
  },
})
gitment.render('gitmentContainer')
</script>

  
  
</article>
</section>
        <aside id="sidebar">
  
    <div class="widget-box">
  <div class="avatar-box">
    <div class="avatar"  title="头像来自网络"></div>
    <h3 class="avatar-name">
      
        Promise
      
    </h3>
    <p class="avatar-slogan">
      Do not, for one repulse, give up the purpose that you resolved to effect.
    </p>
  </div>
</div>


  
    

  
    
  <div class="widget-box">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/CSS/" rel="tag">CSS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ES6/" rel="tag">ES6</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Echarts/" rel="tag">Echarts</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Git/" rel="tag">Git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTML/" rel="tag">HTML</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JS/" rel="tag">JS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/" rel="tag">Java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/React/" rel="tag">React</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Redux/" rel="tag">Redux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SQL/" rel="tag">SQL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Vue/" rel="tag">Vue</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Vuex/" rel="tag">Vuex</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jQuery/" rel="tag">jQuery</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF/" rel="tag">前端</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" rel="tag">数据结构</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BB%BC%E5%90%88/" rel="tag">综合</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BD%91%E7%BB%9C/" rel="tag">网络</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-box">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/CSS/" style="font-size: 15.45px;">CSS</a> <a href="/tags/ES6/" style="font-size: 15.45px;">ES6</a> <a href="/tags/Echarts/" style="font-size: 10.91px;">Echarts</a> <a href="/tags/Git/" style="font-size: 10.91px;">Git</a> <a href="/tags/HTML/" style="font-size: 11.82px;">HTML</a> <a href="/tags/JS/" style="font-size: 20px;">JS</a> <a href="/tags/Java/" style="font-size: 17.27px;">Java</a> <a href="/tags/React/" style="font-size: 19.09px;">React</a> <a href="/tags/Redux/" style="font-size: 13.64px;">Redux</a> <a href="/tags/SQL/" style="font-size: 16.36px;">SQL</a> <a href="/tags/Vue/" style="font-size: 14.55px;">Vue</a> <a href="/tags/Vuex/" style="font-size: 10px;">Vuex</a> <a href="/tags/jQuery/" style="font-size: 10.91px;">jQuery</a> <a href="/tags/%E5%89%8D%E7%AB%AF/" style="font-size: 18.18px;">前端</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" style="font-size: 11.82px;">数据结构</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size: 12.73px;">算法</a> <a href="/tags/%E7%BB%BC%E5%90%88/" style="font-size: 10.91px;">综合</a> <a href="/tags/%E7%BD%91%E7%BB%9C/" style="font-size: 17.27px;">网络</a>
    </div>
  </div>

  
    
  <div class="widget-box">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">December 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">November 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">October 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">September 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">August 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">July 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">June 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">May 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">April 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">March 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">December 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">November 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">September 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">June 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">May 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">April 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">February 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">June 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">March 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">February 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">April 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">March 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">February 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">January 2016</a></li></ul>
    </div>
  </div>

  
    
  <div class="widget-box">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/12/15/Java-%E5%8F%8D%E5%B0%84/">Java反射</a>
          </li>
        
          <li>
            <a href="/2021/12/15/%E5%89%8D%E7%AB%AF-Tomcat%E9%83%A8%E7%BD%B2/">Tomcat部署前端项目</a>
          </li>
        
          <li>
            <a href="/2021/12/01/Java-%E5%BA%8F%E5%88%97%E5%8C%96/">Java序列化</a>
          </li>
        
          <li>
            <a href="/2021/11/29/Java-%E6%B3%9B%E5%9E%8B/">Java泛型</a>
          </li>
        
          <li>
            <a href="/2021/11/28/Java-%E6%9E%9A%E4%B8%BE/">Java枚举</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
      </div>
      <footer id="footer">
  <div class="foot-box global-width">
    &copy; 2023 Infatuation &nbsp;&nbsp;
    <!-- Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> -->
    <!-- &nbsp;|&nbsp;主题 <a target="_blank" rel="noopener" href="https://github.com/yiluyanxia/hexo-theme-antiquity">antiquity</a> -->
    <!-- <br> -->
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span id="busuanzi_container_site_pv">阁下是第<span id="busuanzi_value_site_pv"></span>个访客</span>
  </div>
</footer>
      <!-- <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script> -->

<script src="https://thisisloves.github.io/Infatuation/js/jquery-2.0.3.min.js"></script>
<script src="https://thisisloves.github.io/Infatuation/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script>

  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




    </div>
    <nav id="mobile-nav" class="mobile-nav-box">
  <div class="mobile-nav-img mobile-nav-top"></div>
  
    <a href="/" class="mobile-nav-link">首页</a>
  
    <a href="/archives" class="mobile-nav-link">归档</a>
  
    <a href="https://thisisloves.github.io/chart" class="mobile-nav-link">图表</a>
  
    <a href="https://thisisloves.github.io/shop/" class="mobile-nav-link">购物</a>
  
    <a href="https://thisisloves.github.io/cherry" class="mobile-nav-link">半帘梦</a>
  
    <a href="https://thisisloves.github.io/userInfo/index.html" class="mobile-nav-link">个人中心</a>
  
  <div class="mobile-nav-img  mobile-nav-bottom"></div>
</nav>    
  </div>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>